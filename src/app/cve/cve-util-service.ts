import { Injectable } from "@angular/core";
import { Search } from "./models/utils.model"

export interface tabInfo {
    icon: string;
    title: string;
}

export class Pagination {
    currentPage: number = 1;
    totalPages: number = 0;
}
@Injectable({
    providedIn: "root",
})
export class CveUtilService {
    paginationObject: Pagination = new Pagination();
    vulnerabilities: any[] = [];

    tabs: tabInfo[] = [
        {
            icon: 'fa fa-book',
            title: 'Description',
        },
        {
            icon: 'fa fa-list',
            title: 'Vulnerability Sources',
        },
        {
            icon: 'fa fa-box',
            title: 'Affected Products',
        },
        {
            icon: 'fa fa-tags',
            title: 'VDO Labels',
        },
        {
            icon: 'fa fa-file-lines',
            title: 'SSVC Scores',
        },
        {
            icon: 'fa fa-shield',
            title: 'Patches',
        },
        {
            icon: 'fa fa-wrench',
            title: 'Fixes',
        },
        {
            icon: 'fa-solid fa-circle-exclamation',
            title: 'Exploits',
        },
    ];

    displayTabs: tabInfo[] = [
        {
            icon: 'fa fa-book',
            title: 'Description',
        },
        {
            icon: 'fa fa-link',
            title: 'Vulnerability Sources',
        },
        {
            icon: 'fa fa-box',
            title: 'Affected Products',
        },
        {
            icon: 'fa fa-wrench',
            title: 'Patches and Fixes',
        },
        {
            icon: 'fa-solid fa-circle-exclamation',
            title: 'Exploits',
        },
    ];

    constructor() {
        this.searchObject = new Search();
    }

    extractSourceName(url: string, alt: string): string {
        try {
            const parsedUrl = new URL(url);
            return parsedUrl.hostname;
        } catch (e) {
            return alt;
        }
    }
    searchObject: Search = new Search();
}